---
title: "Sistemas de Recomendación Basados en Ubicación. Introducción a Datos Espaciales"
author: 
  - "Ignacio Sarmiento Barbieri"
date: "20 de Abril, 2023"
output:
  xaringan::moon_reader:
    seal: false # saco filmina de inicio
    lib_dir: libs
    css: xaringan-themer.css
    nature:
      ratio: 191:100
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "https://platform.twitter.com/widgets.js"
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```


```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
library(xaringanExtra)
library(tidyverse)
library(knitr)
#library(icon)
library(nomnoml)
#library(countdown)
# xaringanExtra::use_logo(
#   image_url = "https://raw.githubusercontent.com/rstudio/hex-stickers/master/PNG/xaringan.png"
# )
xaringanExtra::use_panelset()
xaringanExtra::use_broadcast()
xaringanExtra::use_share_again()
xaringanExtra::style_share_again(share_buttons = c("twitter", "linkedin"))
xaringanExtra::use_tachyons()
xaringanExtra::use_fit_screen()
xaringanExtra::use_tile_view() # O
xaringanExtra::use_scribble()
style_mono_accent(
  base_color = "#3D5A85",
  background_color = "#ffffff",
  inverse_background_color = "#3D5A85",
  header_color = "#3D5A85",
  inverse_header_color = "#ffffff", 
  inverse_text_color = "#ffffff",
  code_inline_color = "#3D5A85",
  link_color= "#3D5A85",
  footnote_color =  "#3D5A85",
  text_font_size = "30px",
  header_font_google = google_font("Times", "Regular", "500"),
  text_font_google   = google_font("Darker Grotesque", "500"),
  code_font_google   = google_font("Fira Mono"),
  code_font_size   = "20px"
)
require(kableExtra,quietly=TRUE)
require(tidyverse,quietly=TRUE)
require(lubridate,quietly=TRUE)
require(plotly,quietly=TRUE)
require(scales,quietly=TRUE)
```



class: center, middle

```{r , echo = FALSE, out.width=900, fig.align='center'}
knitr::include_graphics("../../banner.png")
```

#  Sistemas de Recomendación Basados en Ubicación. 

## Introducción a Datos Espaciales


### Ignacio Sarmiento-Barbieri


---
# Sistemas de Recomendación Basados en Ubicación. 

```{r , echo = FALSE, out.width=700, fig.align='center'}
knitr::include_graphics("figures/layers.png")
```

---
# Motivación: Sistemas de Recomendación Basados en Ubicación. 

```{r , echo = FALSE, out.width=700, fig.align='center'}
knitr::include_graphics("figures/example_recomend1.jpg")
```

---
# Motivación: Sistemas de Recomendación Basados en Ubicación. 

```{r , echo = FALSE, out.width=700, fig.align='center'}
knitr::include_graphics("figures/example_recomend2.jpg")
```

---
# Sistemas de Recomendación Basados en Ubicación. 

```{r , echo = FALSE, out.width=700, fig.align='center'}
knitr::include_graphics("figures/foursquare.png")
```

---
# Motivación: Sistemas de Recomendación Basados en Ubicación. 

```{r , echo = FALSE, out.width=700, fig.align='center'}
knitr::include_graphics("figures/net_col.PNG")
```

---
# Motivación: Sistemas de Recomendación Basados en Ubicación. 

```{r , echo = FALSE, out.width=700, fig.align='center'}
knitr::include_graphics("figures/net_ar.PNG")
```

---
# Motivación: Sistemas de Recomendación Basados en Ubicación. 

```{r , echo = FALSE, out.width=700, fig.align='center'}
knitr::include_graphics("figures/net_all.PNG")
```


---
# Types of Spatial Data: Combination

.pull-left[
```{r , echo = FALSE, out.width=700, fig.align='center'}
  knitr::include_graphics("figures/loc_example1.png")
```
]

.pull-right[
```{r , echo = FALSE, out.width=700, fig.align='center'}
  knitr::include_graphics("figures/loc_example2.png")
```
]
Fuente: Bao, Zheng & Mokbel (2012)



---
# Datos Espaciales: Motivación

```{r , echo = FALSE, out.width=700, fig.align='center'}
knitr::include_graphics("figures/blumenstock_fig2.png")
```

---
# Tipos de Datos Espaciales

Los datos espaciales vienen en muchas "formas" y "tamaños", los tipos más comunes de datos espaciales son:

- **Punto**

- **Líneas**

- **Polígonos**

- **Grillas (*o raster*)**


---
# Types of Spatial Data: Points


```{r , echo = FALSE, out.height=500,out.width=500, fig.align='center'}
  knitr::include_graphics("figures/albouy_et_al_fig1.png")
```

Fuente: Albouy, Christensen & Sarmiento-Barbieri (2022)




---
# Types of Spatial Data: Lines


```{r , echo = FALSE, out.width=500, fig.align='center'}
  knitr::include_graphics("figures/safe_passage.png")
```





---
# Types of Spatial Data: Polygons


```{r , echo = FALSE, out.height=450, fig.align='center'}
  knitr::include_graphics("figures/upz_1.png")
```
  Fuente: https://datosabiertos.bogota.gov.co/dataset/unidad-de-planeamiento-bogota-d-c



---
# Types of Spatial Data: Combination

.pull-left[
```{r , echo = FALSE, out.width=700, fig.align='center'}
  knitr::include_graphics("figures/ZIP_A.png")
```
]

.pull-right[
```{r , echo = FALSE, out.width=700, fig.align='center'}
  knitr::include_graphics("figures/ZIP_B.png")
```
]
Fuente: Christensen,Sarmiento-Barbieri  & Timmins (2020)



---
# Types of Spatial Data: Rasters


```{r , echo = FALSE, out.width=400, fig.align='center'}
  knitr::include_graphics("figures/NewYork-1.png")
```
Fuente: https://data.cityofnewyork.us/Environment/NYCCAS-Air-Pollution-Rasters/q68s-8qxv



---
# Reading and Mapping spatial data 
## Shapefiles

Main files

  -  `file.shp`
  -  `file.shx`
  -  `file.dbf`

Other files

  -  `file.prj`
  - `file.sbn` , `file.sbx`
  -  `file.shp.xml`
    

---
# Reading and Mapping spatial data 
## GeoJSON



```{r, eval=FALSE}
{
  "type": "Feature",
  "geometry": {
    "type": "Point",
    "coordinates": [-74.066391, 4.601590]
  },
  "properties": {
    "name": "Universidad de Los Andes"
  }
}
```


---
# Projections: The earth ain't flat

  - The world is an irregularly shaped ellipsoid, but plotting devices are flat
	
	- But if you want to show it on a flat map you need a map projection, 
	
	- This  will determine how to transform and distort latitudes and longitudes to preserve some of the map properties: area, shape, distance, direction or bearing



---
# The earth ain't flat


- Map projections try to portray the surface of the earth or a portion of the earth on a flat piece of paper or computer screen. 
- A coordinate reference system (CRS) then defines, with the help of coordinates, how the two-dimensional, projected map in your GIS is related to real places on the earth. 



```{r , echo = FALSE, out.width=800, fig.align='center'}
  knitr::include_graphics("figures/world-1.png")
```


---
# The earth ain't flat

- For example, sailors use Mercator projection where meridians and parallels cross each other always at the same 90 degrees angle.
- It allows to easy locate your self on the line showing direction in which you sail
- But the projection do not preserve  distances

```{r , echo = FALSE, out.width=800, fig.align='center'}
  knitr::include_graphics("figures/Mercator.png")
```



---
# The earth ain't flat


```{r , echo = FALSE, out.width=800, fig.align='center'}
  knitr::include_graphics("figures/mercator_true_size.jpeg")
```

---
# The earth ain't flat


```{r , echo = FALSE, out.width=800, fig.align='center'}
  knitr::include_graphics("figures/Mexico_Greenland.gif")
```



---
# Which projection should I choose?

- “There exist no all-purpose projections, all involve distortion when far from the center of the specified frame” (Bivand, Pebesma, and Gómez-Rubio 2013)

- The decision as to which map projection and coordinate reference system to use, depends on the regional extent of the area you want to work in, on the analysis you want to do and often on the availability of data.

- In some cases, it is not something that we are free to decide: “often the choice of projection is made by a public mapping agency” (Bivand, Pebesma, and Gómez-Rubio 2013).
  - This means that when working with local data sources, it is likely preferable to work with the CRS in which the data was provided.

---
# Coordinate Reference System (CRS) 

  - With the help of coordinate reference systems (CRS) every place on the earth can be specified by  coordinates.



```{r , echo = FALSE, out.width=800, fig.align='center'}
  knitr::include_graphics("figures/proj.png")
```
Source: \url{https://www.geoawesomeness.com/all-map-projections-in-compared-and-visualized/}


---
# Coordinate Reference System (CRS) 


-  Geographic coordinate systems: coordinate systems that span the entire globe (e.g. latitude / longitude).
 
    - WGS84 is the most common CRS in the world,  EPSG code: 4326. 
    
    - For Bogotá the IGAC promotes the adoption of MAGNA-SIRGAS.
   
- Projected coordinate systems: coordinate systems that are localized to minimize visual distortion in a particular region (e.g. Robinson, UTM, State Plane)

- All CRS have an \href{https://epsg.org/home.html}{EPSG} code, which  is a collection of definitions of coordinate reference systems and coordinate transformations which may be global, regional, national or local in application.
-  The EPSG Geodetic Parameter Dataset is maintained by the Geodesy Subcommittee of the IOGP Geomatics Committee.


---
class: center, middle

#  Break y volvemos con Python

